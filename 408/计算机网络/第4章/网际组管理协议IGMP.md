---
tags: 计算机网络  [obsidian]
cards-deck: 考研::计算机网络
---

![[Pasted image 20220918160611.png]]

IPv4:{2:224.0.0.1} 仅在本子网上所有参加的多播的==主机和路由器==
^1663493496882
IPv4:{2:224.0.0.2} 仅在本子网上所有参加的多播的==路由器==
^1663493496890

# IGMP报文
![[Pasted image 20220918171256.png]]

- IGMP报文被封装在==IP数据报==中传送
^1663493496895
- IGMP的协议字号是:==2==
^1663493496900
- IGMP的TTL= ==1==,目的是:避免封装有IGMP的报文的IP多播数据报被{2:路由器转发到其他网络}
^1663493496903
- 封装有IGMP报文的IP数据报都是==IP多播数据==报
^1663493496908

# IGMP的基本工作原理

## 加入多播组
- 当一个主机中的某个进程要加入某个多播组时,该主机会向其所在网络发送一个封装有IGMP==成员报告==报文的IP多播数据报
^1663493496911
- 多播路由器被设置为==接收==所有的IP多播组地址
^1663493496917
- 如果本网络中还有同组其他成员要发送IGMP成员报告加入该多播组,则监听到该IP多播数据报后就==取消发送==
^1663493496920
	- 当监听到同组多播组成员发送的报文后为什么要取消发送? :: 因为每个网络中的每个多播组仅需要一个成员发送IGMP成员报告报文即可 ^1663493496924

![[Pasted image 20220918172507.png]]

IGMP成员报文的IP多播数据报信息:
- 报告报文的内容:加入的IP多播地址
- IP多播数据报的目的地址:加入的IP多播地址
- 以太网多播帧的目的地址:多播MAC地址(由IP目的地址映射而来)

当多播路由器接收到一个未知的多播组的IGMP成员报告,就会将该多播组的地址添加到主机的==多播组列表==中
^1663493496927
多播组路由器不关心自己所在网络中每个多播组成员数量? ::正确 ^1663493496932

## 监视成员变化
多播路由器默认每隔125s就向其自连的网络发送一个封装有IGMP==成员查询==报文IP多播数据报
^1663501358909
IGMP成员查询报文的报文内容为:==查询的特定多播组地址==或==全部多播组的地址0.0.0.0==
^1663501358919
IGMP成员查询报文的IP多播数据报的目的地址为:==224.0.0.1(特殊的IP多播地址)==
^1663501358926

![[Pasted image 20220918183759.png]]

- IGMP成员查询报文的报文内容为:查询的特定多播组地址或全部多播组的地址
- IP多播数据报的目的地址为:224.0.0.1,特殊的IP多播地址
- 以太网多播帧的目的地址为:多播MAC地址(由IP目的地址映射而来)

![[Pasted image 20220918190546.png]]

![[Pasted image 20220918191120.png]]

- 收到IGMP成员查询报文的主机,并不是立即响应,而是在1-10s的范围内等待一段随机的时间后再进行响应
	- 如果在这段随机的时间内收到了同组其他成员发送的IGMP成员报告报文,就==取消响应==
^1663501358931

多播路由器如果长时间没有收到某个多播组的成员报告,则将该多播组从自己的多播组列表中==删除==
^1663501358935


## 退出多播组
当主机要退出某个多播组时,可以主动发送一个==离开组==报文而不必等待多播路由器的查询,这样可使多播路由器能够更快地发现某个组有成员离开
^1663501358940

IGMP成员离开组报文的报文内容为:==要退出的多播组地址====
^1663501358944
IGMP成员离开组报文的IP多播数据报的目的地址为:==224.0.0.2(特殊的IP多播地址)==
^1663501358947
![[Pasted image 20220918193324.png]]

- IGMP成员离开组报文的报文内容为:要退出的多播组地址
- IP多播数据报的目的地址为:224.0.0.2,特殊的IP多播地址
- 以太网多播帧的目的地址为:多播MAC地址(由IP目的地址映射而来)

当一个成员退出了该多播组后,多播路由器并不知道该多播组是否还有其他成员,因此==暂时不会==(不会/会)删除该多播组;多播路由器回立即针对该多播组发送一个特殊的IGMP成员查询报文,该地址为==退出的多播组==地址,而不是特殊多播地址224.0.0.1
^1663501358953
